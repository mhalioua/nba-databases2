<div class="header row">
  <h1><%= @head + " Matchups"%></h1>
</div>

<ul>
  <li><%= link_to 'Home', { action: 'home' }%></li>
</ul>
<div class="dateselect" style="text-align: center;">
  <button class="btn btn-primary prevbutton" style="margin:10px; padding: 5px 20px;">Prev Day</button>
  <button class="btn btn-primary nextbutton" style="margin:10px; padding: 5px 20px;">Next Day</button>
</div>
<table border="1">
  	<thead>
  		<tr>
	  		<th></th>
	      	<th></th>
	      	<th>Days<br>rest</th>
	  		<th colspan="8">TODAYS GAMES</th>
	  		<th>Days<br>rest</th>
        <th></th>
        <th rowspan="2"></th>
        <th colspan="7">1H STATS</th>
        <th></th>
        <th></th>
        <th class="purple"></th>
        <th colspan="3">LINES</th>
        <th class="purple"></th>
        <th colspan="4"></th>
        <th class="black"></th>
        <th colspan="4"></th>
        <th class="black"></th>
        <th></th>
        <th class="black"></th>
        <th colspan="4"></th>
        <th class="black"></th>
        <th colspan="5"></th>
	    </tr>
	  	<tr>
	  		<th>Game ID</th>
	      	<th class="red">Time</th>
	      	<th class="red">Last<br>Game</th>
	      	<th class="red">Away Team</th>
	  		<th class="red">Next<br>Game</th>
	  		<th class="red" colspan="3"></th>
	  		<th class="red">Next<br>Game</th>
        <th>FLY</th>
	  		<th class="red">Home Team</th>
	  		<th class="red">Last<br>Game</th>
        <th>FLY</th>
        <th class="red">1H<br>FGA</th>
        <th class="red">1H<br>FTA</th>
        <th class="red">1H<br>ORB</th>
        <th class="red">1H<br>TO</th>
        <th class="red">1H<br>STL</th>
        <th class="red">1H<br>BLK</th>
        <th class="darkred">1H<br>poss's</th>
        <th class="red">2H<br>poss</th>
        <th class="red">FG<br>poss</th>
        <th class="purple"></th>
        <th class="red">1H</th>
        <th class="red">EST<br>2H</th>
        <th class="red">FG</th>
        <th class="purple"></th>
        <th class="red" colspan="4"></th>
        <th class="black"></th>
        <th class="red" colspan="4">FULL GAME</th>
        <th class="black"></th>
        <th class="red"></th>
        <th class="black"></th>
        <th class="red" colspan="4">1ST HALF</th>
        <th class="black"></th>
        <th class="red" colspan="5">2ND HALF</th>
	    </tr>
  	</thead>
  	<tbody>
    <% @games.each_with_index do |game, index| %>
    <tr>
      <td class="green" rowspan="3"><%= game.away_number %> / <%= game.home_number %></td>
      <td class="grey" rowspan="3"><%= DateTime.parse(game.game_date).strftime("%I:%M%n%p") %></td>
      <td class="yellow" rowspan="3"><%= game.away_last_game %></td>
      <td rowspan="3"><%= game.away_team %></td>
      <td class="yellow" rowspan="3"><%= game.away_next_game %></td>
      <td class="red" rowspan="3"><%= link_to '@', { action: 'detail', id: game.game_id }%></td>
      <td class="red" rowspan="3"><%= link_to 'Stat', { action: 'stat', id: game.game_id }%></td>
      <td class="red" rowspan="3"><%= link_to 'Filter', { action: 'rest', id: game.game_id }%></td>
      <td class="yellow" rowspan="3"><%= game.home_next_game %></td>
      <td class="green" rowspan="3"><%= game.home_next_fly %></td>
      <td rowspan="3"><%= game.home_team %></td>
      <td class="yellow" rowspan="3"><%= game.home_last_game %></td>
      <td class="green" rowspan="3"><%= game.home_last_fly %></td>

      <td class="darkred"><%= game.away_abbr %></td>
      <td><%= game.first_away_fga %></td>
      <td><%= game.first_away_fta %></td>
      <td><%= game.first_away_orValue %></td>
      <td><%= game.first_away_toValue %></td>
      <td><%= game.first_away_stl %></td>
      <td><%= game.first_away_blk %></td>
      <% if game.first_away_fga && game.first_away_toValue && game.first_away_fta && game.first_away_orValue %>
      <td class="darkred"><%= (game.first_away_fga + game.first_away_toValue + (game.first_away_fta * 0.44) - game.first_away_orValue).round(2) %></td>
      <% else %>
      <td class="darkred"></td>
      <% end %>
      <% if game.first_away_fga && game.first_away_toValue && game.first_away_fta && game.first_away_orValue && game.away_fga && game.away_toValue && game.away_fta && game.away_orValue %>
      <td><%= (game.away_fga + game.away_toValue + (game.away_fta * 0.44) - game.away_orValue - game.first_away_fga - game.first_away_toValue - (game.first_away_fta * 0.44) + game.first_away_orValue).round(2) %></td>
      <% else %>
      <td></td>
      <% end %>
      <% if game.away_fga && game.away_toValue && game.away_fta && game.away_orValue %>
      <td><%= (game.away_fga + game.away_toValue + (game.away_fta * 0.44) - game.away_orValue).round(2) %></td>
      <% else %>
      <td></td>
      <% end %>
      <td class="purple">Total</td>
      <td><%= game.first_closer_total %></td>
      <td><%= game.second_closer_total != 0 ? game.second_closer_total : (game.full_closer_total - game.first_closer_total) %></td>
      <td><%= game.full_closer_total %></td>
      <% @countItem = Count.where("lastroad like ? AND nextroad like ? AND nexthome like ? AND lasthome like ?", "%#{game.away_last_game}%", "%#{game.away_next_game}%", "%#{game.home_next_game}%", "%#{game.home_last_game}%").first %>
      <td class="purple"></td>
        <td><%= @countItem ? @countItem.lastroad : "" %></td>
        <td><%= @countItem ? @countItem.nextroad : "" %></td>
        <td><%= @countItem ? @countItem.nexthome : "" %></td>
        <td><%= @countItem ? @countItem.lasthome : "" %></td>
        <td rowspan="3" class="black"></td>
        <td><%= @countItem ? @countItem.road : "" %></td>
        <td><%= @countItem ? @countItem.home : "" %></td>
        <td class="purple"><%= @countItem ? (@countItem.home + @countItem.road).round(2) : "" %></td>
        <td><%= @countItem ? @countItem.diff : "" %></td>
        <td rowspan="3" class="black"></td>
        <td style="background: #fa0"><%= @countItem ? @countItem.count : "" %></td>
        <td rowspan="3" class="black"></td>
        <td><%= @countItem ? @countItem.firstroad : "" %></td>
        <td><%= @countItem ? @countItem.firsthome : "" %></td>
        <td class="purple"><%= @countItem ? (@countItem.firstroad + @countItem.firsthome).round(2) : "" %></td>
        <td><%= @countItem ? @countItem.firstdiff : "" %></td>
        <td rowspan="3" class="black"></td>
        <td><%= @countItem ? @countItem.secondroad : "" %></td>
        <td><%= @countItem ? @countItem.secondhome : "" %></td>
        <td class="purple"><%= @countItem ? (@countItem.secondroad + @countItem.secondhome).round(2) : "" %></td>
        <td><%= @countItem ? @countItem.seconddiff : "" %></td>
        <td>1</td>
    </tr>
    <tr>
      <td class="darkred" ><%= game.home_abbr %></td>
      <td><%= game.first_home_fga %></td>
      <td><%= game.first_home_fta %></td>
      <td><%= game.first_home_orValue %></td>
      <td><%= game.first_home_toValue %></td>
      <td><%= game.first_home_stl %></td>
      <td><%= game.first_home_blk %></td>
      <% if game.first_home_fga && game.first_home_toValue && game.first_home_fta && game.first_home_orValue %>
      <td class="darkred"><%= (game.first_home_fga + game.first_home_toValue + (game.first_home_fta * 0.44) - game.first_home_orValue).round(2) %></td>
      <% else %>
      <td class="darkred"></td>
      <% end %>
      <% if game.first_home_fga && game.first_home_toValue && game.first_home_fta && game.first_home_orValue && game.home_fga && game.home_toValue && game.home_fta && game.home_orValue %>
      <td><%= (game.home_fga + game.home_toValue + (game.home_fta * 0.44) - game.home_orValue - game.first_home_fga - game.first_home_toValue - (game.first_home_fta * 0.44) + game.first_home_orValue).round(2) %></td>
      <% else %>
      <td></td>
      <% end %>
      <% if game.home_fga && game.home_toValue && game.home_fta && game.home_orValue %>
      <td><%= (game.home_fga + game.home_toValue + (game.home_fta * 0.44) - game.home_orValue).round(2) %></td>
      <% else %>
      <td></td>
      <% end %>
      <td class="purple">Sides</td>
      <td><%= game.first_closer_side %></td>
      <td><%= game.second_closer_side != 0 ? game.second_closer_side : (game.full_closer_side - game.first_closer_side) %></td>
      <td><%= game.full_closer_side %></td>
      <td class="purple"></td>
      <td style="background: #fa0">ALL</td>
      <td style="background: #fa0">ALL</td>
      <td style="background: #fa0">ALL</td>
      <td style="background: #fa0">ALL</td>
      <td style="background: #fa0">97</td>
      <td style="background: #fa0">100.12</td>
      <td class="purple">197.12</td>
      <td style="background: #fa0">-3.12</td>
      <td style="background: #fa0">17955</td>
      <td style="background: #fa0">48.49</td>
      <td style="background: #fa0">50.32</td>
      <td class="purple">98.81</td>
      <td style="background: #fa0">-1.83</td>
      <td style="background: #fa0">48.51</td>
      <td style="background: #fa0">49.80</td>
      <td class="purple">98.31</td>
      <td style="background: #fa0">-1.29</td>
      <td style="background: #fa0">ALL</td>
    </tr>
    <tr>
      <td class="skyblue"><%= game.away_abbr %></td>
      <td class="skyblue"><%= game.away_first_quarter %></td>
      <td class="skyblue"><%= game.away_second_quarter %></td>
      <td class="skyblue"><%= game.away_third_quarter %></td>
      <td class="skyblue"><%= game.away_forth_quarter %></td>
      <td class="skyblue"><%= game.home_abbr %></td>
      <td class="skyblue"><%= game.home_first_quarter %></td>
      <td class="skyblue"><%= game.home_second_quarter %></td>
      <td class="skyblue"><%= game.home_third_quarter %></td>
      <td class="skyblue"><%= game.home_forth_quarter %></td>
      <td class="purple"></td>
      <td class="purple"></td>
      <td class="purple"></td>
      <td class="purple"></td>
      <td class="purple"></td>
      <% if game.home_next_fly == "NO" && game.home_last_fly == "YES" %>
          <td class="gray"></td>
          <td class="gray">NO</td>
          <td class="gray">YES</td>
          <td class="gray"></td>
          <td class="gray">96.75</td>
          <td class="gray">99.83</td>
          <td class="purple">196.58</td>
          <td class="gray">-3.08</td>
          <td style="background: #fa0">4949</td>
          <td class="gray">48.23</td>
          <td class="gray">50.11</td>
          <td class="purple">98.34</td>
          <td class="gray">-1.88</td>
          <td class="gray">48.52</td>
          <td class="gray">49.72</td>
          <td class="purple">98.24</td>
          <td class="gray">-1.2</td>
      <% elsif game.home_next_fly == "YES" && game.home_last_fly == "NO" %>
          <td class="gray"></td>
          <td class="gray">YES</td>
          <td class="gray">NO</td>
          <td class="gray"></td>
          <td class="gray">97.14</td>
          <td class="gray">100.15</td>
          <td class="purple">197.29</td>
          <td class="gray">-3.01</td>
          <td style="background: #fa0">4929</td>
          <td class="gray">48.55</td>
          <td class="gray">50.38</td>
          <td class="purple">98.93</td>
          <td class="gray">-1.83</td>
          <td class="gray">48.59</td>
          <td class="gray">49.77</td>
          <td class="purple">98.36</td>
          <td class="gray">-1.18</td>
      <% elsif game.home_next_fly == "YES" && game.home_last_fly == "YES" %>
          <td class="gray"></td>
          <td class="gray">YES</td>
          <td class="gray">YES</td>
          <td class="gray"></td>
          <td class="gray">96.76</td>
          <td class="gray">99.65</td>
          <td class="purple">196.41</td>
          <td class="gray">-2.89</td>
          <td style="background: #fa0">3931</td>
          <td class="gray">48.44</td>
          <td class="gray">50.06</td>
          <td class="purple">98.5</td>
          <td class="gray">-1.62</td>
          <td class="gray">48.32</td>
          <td class="gray">49.59</td>
          <td class="purple">97.91</td>
          <td class="gray">-1.27</td>
      <% elsif game.home_next_fly == "NO" && game.home_last_fly == "NO" %>
          <td class="gray"></td>
          <td class="gray">NO</td>
          <td class="gray">NO</td>
          <td class="gray"></td>
          <td class="gray">97.3</td>
          <td class="gray">100.85</td>
          <td class="purple">197.88</td>
          <td class="gray">-3.55</td>
          <td style="background: #fa0">4129</td>
          <td class="gray">48.78</td>
          <td class="gray">50.76</td>
          <td class="purple">99.54</td>
          <td class="gray">-1.98</td>
          <td class="gray">48.52</td>
          <td class="gray">50.09</td>
          <td class="purple">98.61</td>
          <td class="gray">-1.57</td>
      <% else %>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="purple"></td>
        <td class="gray"></td>
        <td style="background: #fa0"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="purple"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="gray"></td>
        <td class="purple"></td>
        <td class="gray"></td>
      <% end %>
      <td class="gray"></td>
    </tr>
    <% end %>
  	</tbody>
</table>

<script type="text/javascript">
    $('.prevbutton').click(function(){
      window.location.href = "/index/game/" + <%= @prev %>;
    }); 
    $('.nextbutton').click(function(){
      window.location.href = "/index/game/" + <%= @next %>;
    });
</script>

<div style="
    position: absolute;
    top: 10px;
    left: 10px;
">
  <button class="btn btn-danger refreshbutton">Refresh</button>
</div>
  
<script>
 $('.refreshbutton').click(function(){
    window.location.href = window.location.href;
  });
</script>